apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "llm-gateway.fullname" . }}-config
  labels:
    {{- include "llm-gateway.labels" . | nindent 4 }}
data:
  # Cache configuration
  CACHE_ENABLED: "{{ .Values.gateway.cache.enabled }}"
  CACHE_TYPE: "{{ .Values.gateway.cache.type }}"
  CACHE_TTL_SECONDS: "{{ .Values.gateway.cache.ttlSeconds }}"
  CACHE_MAX_SIZE: "{{ .Values.gateway.cache.maxSize }}"
  CACHE_SIMILARITY_THRESHOLD: "{{ .Values.gateway.cache.semanticSimilarityThreshold }}"

  # Routing configuration
  ROUTING_DEFAULT_STRATEGY: "{{ .Values.gateway.routing.defaultStrategy }}"

  # Reliability configuration
  RETRY_ATTEMPTS: "{{ .Values.gateway.reliability.retryAttempts }}"
  RETRY_DELAY_MS: "{{ .Values.gateway.reliability.retryDelayMs }}"
  CIRCUIT_BREAKER_FAILURE_THRESHOLD: "{{ .Values.gateway.reliability.circuitBreaker.failureThreshold }}"
  CIRCUIT_BREAKER_RECOVERY_MS: "{{ .Values.gateway.reliability.circuitBreaker.recoveryTimeMs }}"

  # Security configuration
  PII_DETECTION_ENABLED: "{{ .Values.gateway.security.piiDetection.enabled }}"
  PII_DETECTION_ACTION: "{{ .Values.gateway.security.piiDetection.action }}"
  PROMPT_INJECTION_ENABLED: "{{ .Values.gateway.security.promptInjection.enabled }}"
  PROMPT_INJECTION_ACTION: "{{ .Values.gateway.security.promptInjection.action }}"

  # Cost configuration
  BUDGET_DAILY: "{{ .Values.gateway.cost.budgets.daily }}"
  BUDGET_WEEKLY: "{{ .Values.gateway.cost.budgets.weekly }}"
  BUDGET_MONTHLY: "{{ .Values.gateway.cost.budgets.monthly }}"
  COST_ALERTS_ENABLED: "{{ .Values.gateway.cost.alerts.enabled }}"

  # Observability configuration
  LOG_LEVEL: "{{ .Values.observability.logging.level }}"
  LOG_FORMAT: "{{ .Values.observability.logging.format }}"
  TRACING_ENABLED: "{{ .Values.observability.tracing.enabled }}"
  METRICS_ENABLED: "{{ .Values.observability.metrics.enabled }}"
  METRICS_PORT: "{{ .Values.observability.metrics.port }}"

  {{- if .Values.gateway.providers.ollama.enabled }}
  OLLAMA_BASE_URL: "{{ .Values.gateway.providers.ollama.baseUrl }}"
  {{- end }}
